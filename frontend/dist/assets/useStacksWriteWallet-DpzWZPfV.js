import{r as y}from"./react-vendor-CIGKTyFs.js";import{u as P,E as F,e as c,S as E,g as C,n as M,s as h,P as S}from"./index-DrNp6A46.js";import{z as e}from"./ui-vendor-BDTlLGxs.js";import{i as k,p as w,r as N}from"./useStacksRead-BF2QryqZ.js";const v=E;function m(){const{address:n}=P(),[l,o]=y.useState(!1),[p,d]=y.useState(null);return{makeCall:async(t,r,g,a={})=>{if(!n){const i=new Error("Please connect your Stacks wallet");throw d(i),e.error(i.message),i}o(!0),d(null);try{const i=N(t),{address:u,contractName:f}=w(i);await F({contractAddress:u,contractName:f,functionName:r,functionArgs:g,network:v,postConditions:a.postConditions||[],postConditionMode:a.postConditionMode||S.Deny,onFinish:()=>{e.success("Transaction submitted!"),o(!1)},onCancel:()=>{e.error("Transaction cancelled"),o(!1)}})}catch(i){const u=i instanceof Error?i:new Error((i==null?void 0:i.message)||"Transaction failed");throw d(u),e.error(u.message),o(!1),u}},isPending:l,error:p}}function W(){const{address:n}=P(),{makeCall:l,isPending:o,error:p}=m(),[d,s]=y.useState(!1);return{depositRent:async(r,g)=>{if(!n){e.error("Please connect your Stacks wallet");return}try{s(!0),e.loading("Transferring USDCx to rent vault...",{id:"transfer"});const a=k("testnet"),{address:i,contractName:u}=w(a),f=N("rent-vault"),{address:A}=w(f),x=BigInt(Math.floor(parseFloat(g)*1e6));await F({contractAddress:i,contractName:u,functionName:"transfer",functionArgs:[c(x),C(n),C(A),M()],network:v,onFinish:async()=>{e.success("USDCx transferred",{id:"transfer"}),s(!1),e.loading("Recording rent deposit...",{id:"deposit"}),await l("rent-vault","deposit-rent",[c(Number(r)),c(x)]),e.success("Rent deposited successfully!",{id:"deposit"})},onCancel:()=>{e.error("Transfer cancelled",{id:"transfer"}),s(!1)}})}catch(a){throw e.error((a==null?void 0:a.message)||"Failed to deposit rent"),s(!1),a}},isPending:o||d,isTransferring:d,error:p}}function V(){const{makeCall:n,isPending:l,error:o}=m();return{claimYield:async(d,s)=>{try{e.loading("Claiming yield...",{id:"claim"}),await n("yield-distributor","claim-yield",[c(Number(d)),c(Number(s))]),e.success("Yield claimed successfully!",{id:"claim"})}catch(t){throw e.error((t==null?void 0:t.message)||"Failed to claim yield"),t}},isPending:l,error:o}}function B(){const{makeCall:n,isPending:l,error:o}=m();return{recordExpense:async(d,s)=>{try{const t=BigInt(Math.floor(parseFloat(s)*1e6));e.loading("Recording operating expense...",{id:"expense"}),await n("cash-flow-engine","record-operating-expense",[c(Number(d)),c(t)]),e.success("Operating expense recorded!",{id:"expense"})}catch(t){throw e.error((t==null?void 0:t.message)||"Failed to record expense"),t}},isPending:l,error:o}}function D(){const{makeCall:n,isPending:l,error:o}=m();return{createProposal:async(d,s,t)=>{try{const r=BigInt(Math.floor(parseFloat(s)*1e6));e.loading("Creating CapEx proposal...",{id:"proposal"}),await n("simple-dao","create-proposal",[c(Number(d)),c(r),h(t)]),e.success("CapEx proposal created!",{id:"proposal"})}catch(r){throw e.error((r==null?void 0:r.message)||"Failed to create proposal"),r}},isPending:l,error:o}}function Y(){const{makeCall:n,isPending:l,error:o}=m();return{voteFor:async(s,t)=>{try{e.loading("Voting for proposal...",{id:"vote"}),await n("simple-dao","vote-for-proposal",[c(Number(s)),c(Number(t))]),e.success("Vote recorded!",{id:"vote"})}catch(r){throw e.error((r==null?void 0:r.message)||"Failed to vote"),r}},voteAgainst:async(s,t)=>{try{e.loading("Voting against proposal...",{id:"vote"}),await n("simple-dao","vote-against-proposal",[c(Number(s)),c(Number(t))]),e.success("Vote recorded!",{id:"vote"})}catch(r){throw e.error((r==null?void 0:r.message)||"Failed to vote"),r}},isPending:l,error:o}}function U(){const{makeCall:n,isPending:l,error:o}=m(),{address:p}=P();return{mintProperty:async(s,t,r,g="")=>{if(!p){e.error("Please connect your Stacks wallet");return}try{const a=BigInt(Math.floor(parseFloat(t)*1e6)),i=BigInt(Math.floor(parseFloat(r)*1e6));e.loading("Minting property NFT...",{id:"mint"}),await n("property-nft","mint-property",[C(p),h(s),c(a),c(i),h(g||s)]),e.success("Property NFT minted successfully!",{id:"mint"})}catch(a){throw e.error((a==null?void 0:a.message)||"Failed to mint property"),a}},isPending:l,error:o}}export{W as a,B as b,V as c,D as d,Y as e,U as u};
