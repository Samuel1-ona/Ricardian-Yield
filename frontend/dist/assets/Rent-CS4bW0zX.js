var ve=Object.defineProperty;var ke=(t,e,r)=>e in t?ve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var w=(t,e,r)=>ke(t,typeof e!="symbol"?e+"":e,r);import{d as Ee,c as Ne,t as Be,p as Ue,g as Y,e as K,i as D,l as X,m as se,j as n}from"./web3-vendor-Ds0lPK1P.js";import{r as x}from"./react-vendor-CIGKTyFs.js";import{C as I,d as P,a as M,b as R,c as T}from"./Card-DWvOJBa6.js";import{u as Z,p as $e,S as Ae,a as De,b as Ie,c as Pe,B as U,d as ne}from"./index-DrNp6A46.js";import{z as p}from"./ui-vendor-BDTlLGxs.js";import{p as Me,i as Re,j as Te,k as _e,E as J,X as ie,D as Le,u as Fe,b as Oe}from"./useStacksRead-BF2QryqZ.js";import{a as He}from"./useStacksWriteWallet-DpzWZPfV.js";import"./charts-vendor-D_nd7r1X.js";const Ve=Ee({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://11155111.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:8928790}},testnet:!0}),ze=Ae;function qe(){const{address:t}=Z(),{data:e,isLoading:r,error:s}=Ne({queryKey:["usdcx-balance",t||""],queryFn:async()=>{if(!t)return null;const i=Re("testnet"),{address:a,contractName:o}=Me(i),d=await Te({contractAddress:a,contractName:o,functionName:"get-balance",functionArgs:[$e(t)],network:ze,senderAddress:t}),c=_e(d);return c.value?BigInt(c.value):BigInt(0)},enabled:!!t,staleTime:10*1e3,refetchInterval:30*1e3});return{balance:e,isLoading:r,error:s,formatted:e?(Number(e)/1e6).toFixed(6):"0.000000"}}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function he(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function We(t){if(!he(t))throw new Error("Uint8Array expected")}function ue(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(r=>typeof r=="string"):e.every(r=>Number.isSafeInteger(r)):!1}function Ye(t){if(typeof t!="function")throw new Error("function expected");return!0}function H(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function fe(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function G(t){if(!Array.isArray(t))throw new Error("array expected")}function pe(t,e){if(!ue(!0,e))throw new Error(`${t}: array of strings expected`)}function Ke(t,e){if(!ue(!1,e))throw new Error(`${t}: array of numbers expected`)}function Xe(...t){const e=a=>a,r=(a,o)=>d=>a(o(d)),s=t.map(a=>a.encode).reduceRight(r,e),i=t.map(a=>a.decode).reduce(r,e);return{encode:s,decode:i}}function Je(t){const e=typeof t=="string"?t.split(""):t,r=e.length;pe("alphabet",e);const s=new Map(e.map((i,a)=>[i,a]));return{encode:i=>(G(i),i.map(a=>{if(!Number.isSafeInteger(a)||a<0||a>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${a}". Allowed: ${t}`);return e[a]})),decode:i=>(G(i),i.map(a=>{H("alphabet.decode",a);const o=s.get(a);if(o===void 0)throw new Error(`Unknown letter: "${a}". Allowed: ${t}`);return o}))}}function Qe(t=""){return H("join",t),{encode:e=>(pe("join.decode",e),e.join(t)),decode:e=>(H("join.decode",e),e.split(t))}}function Ge(t){return Ye(t),{encode:e=>e,decode:e=>t(e)}}const me=(t,e)=>e===0?t:me(e,t%e),V=(t,e)=>t+(e-me(t,e)),Q=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function ae(t,e,r,s){if(G(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(V(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${V(e,r)}`);let i=0,a=0;const o=Q[e],d=Q[r]-1,c=[];for(const h of t){if(fe(h),h>=o)throw new Error(`convertRadix2: invalid data word=${h} from=${e}`);if(i=i<<e|h,a+e>32)throw new Error(`convertRadix2: carry overflow pos=${a} from=${e}`);for(a+=e;a>=r;a-=r)c.push((i>>a-r&d)>>>0);const m=Q[a];if(m===void 0)throw new Error("invalid carry");i&=m-1}if(i=i<<r-a&d,!s&&a>=e)throw new Error("Excess padding");if(!s&&i>0)throw new Error(`Non-zero padding: ${i}`);return s&&a>0&&c.push(i>>>0),c}function Ze(t,e=!1){if(fe(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(V(8,t)>32||V(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!he(r))throw new Error("radix2.encode input should be Uint8Array");return ae(Array.from(r),8,t,!e)},decode:r=>(Ke("radix2.decode",r),Uint8Array.from(ae(r,t,8,e)))}}const et=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",tt={encode(t){return We(t),t.toHex()},decode(t){return H("hex",t),Uint8Array.fromHex(t)}},_=et?tt:Xe(Ze(4),Je("0123456789abcdef"),Qe(""),Ge(t=>{if(typeof t!="string"||t.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}));function rt(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function z(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}const we=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function xe(t){return Object.prototype.toString.call(t)==="[object Object]"}function L(t){return Number.isSafeInteger(t)}const st=t=>{if(t!==null&&typeof t!="string"&&!O(t)&&!z(t)&&!L(t))throw new Error(`lengthCoder: expected null | number | Uint8Array | CoderType, got ${t} (${typeof t})`);return{encodeStream(e,r){if(t===null)return;if(O(t))return t.encodeStream(e,r);let s;if(typeof t=="number"?s=t:typeof t=="string"&&(s=A.resolve(e.stack,t)),typeof s=="bigint"&&(s=Number(s)),s===void 0||s!==r)throw e.err(`Wrong length: ${s} len=${t} exp=${r} (${typeof r})`)},decodeStream(e){let r;if(O(t)?r=Number(t.decodeStream(e)):typeof t=="number"?r=t:typeof t=="string"&&(r=A.resolve(e.stack,t)),typeof r=="bigint"&&(r=Number(r)),typeof r!="number")throw e.err(`Wrong length: ${r}`);return r}}},b={BITS:32,FULL_MASK:-1>>>0,len:t=>Math.ceil(t/32),create:t=>new Uint32Array(b.len(t)),clean:t=>t.fill(0),debug:t=>Array.from(t).map(e=>(e>>>0).toString(2).padStart(32,"0")),checkLen:(t,e)=>{if(b.len(e)!==t.length)throw new Error(`wrong length=${t.length}. Expected: ${b.len(e)}`)},chunkLen:(t,e,r)=>{if(e<0)throw new Error(`wrong pos=${e}`);if(e+r>t)throw new Error(`wrong range=${e}/${r} of ${t}`)},set:(t,e,r,s=!0)=>!s&&t[e]&r?!1:(t[e]|=r,!0),pos:(t,e)=>({chunk:Math.floor((t+e)/32),mask:1<<32-(t+e)%32-1}),indices:(t,e,r=!1)=>{b.checkLen(t,e);const{FULL_MASK:s,BITS:i}=b,a=i-e%i,o=a?s>>>a<<a:s,d=[];for(let c=0;c<t.length;c++){let h=t[c];if(r&&(h=~h),c===t.length-1&&(h&=o),h!==0)for(let m=0;m<i;m++){const u=1<<i-m-1;h&u&&d.push(c*i+m)}}return d},range:t=>{const e=[];let r;for(const s of t)r===void 0||s!==r.pos+r.length?e.push(r={pos:s,length:1}):r.length+=1;return e},rangeDebug:(t,e,r=!1)=>`[${b.range(b.indices(t,e,r)).map(s=>`(${s.pos}/${s.length})`).join(", ")}]`,setRange:(t,e,r,s,i=!0)=>{b.chunkLen(e,r,s);const{FULL_MASK:a,BITS:o}=b,d=r%o?Math.floor(r/o):void 0,c=r+s,h=c%o?Math.floor(c/o):void 0;if(d!==void 0&&d===h)return b.set(t,d,a>>>o-s<<o-s-r,i);if(d!==void 0&&!b.set(t,d,a>>>r%o,i))return!1;const m=d!==void 0?d+1:r/o,u=h!==void 0?h:c/o;for(let S=m;S<u;S++)if(!b.set(t,S,a,i))return!1;return!(h!==void 0&&d!==h&&!b.set(t,h,a<<o-c%o,i))}},A={pushObj:(t,e,r)=>{const s={obj:e};t.push(s),r((i,a)=>{s.field=i,a(),s.field=void 0}),t.pop()},path:t=>{const e=[];for(const r of t)r.field!==void 0&&e.push(r.field);return e.join("/")},err:(t,e,r)=>{const s=new Error(`${t}(${A.path(e)}): ${typeof r=="string"?r:r.message}`);return r instanceof Error&&r.stack&&(s.stack=r.stack),s},resolve:(t,e)=>{const r=e.split("/"),s=t.map(o=>o.obj);let i=0;for(;i<r.length&&r[i]==="..";i++)s.pop();let a=s.pop();for(;i<r.length;i++){if(!a||a[r[i]]===void 0)return;a=a[r[i]]}return a}};class ee{constructor(e,r={},s=[],i=void 0,a=0){w(this,"pos",0);w(this,"data");w(this,"opts");w(this,"stack");w(this,"parent");w(this,"parentOffset");w(this,"bitBuf",0);w(this,"bitPos",0);w(this,"bs");w(this,"view");this.data=e,this.opts=r,this.stack=s,this.parent=i,this.parentOffset=a,this.view=we(e)}_enablePointers(){if(this.parent)return this.parent._enablePointers();this.bs||(this.bs=b.create(this.data.length),b.setRange(this.bs,this.data.length,0,this.pos,this.opts.allowMultipleReads))}markBytesBS(e,r){return this.parent?this.parent.markBytesBS(this.parentOffset+e,r):!r||!this.bs?!0:b.setRange(this.bs,this.data.length,e,r,!1)}markBytes(e){const r=this.pos;this.pos+=e;const s=this.markBytesBS(r,e);if(!this.opts.allowMultipleReads&&!s)throw this.err(`multiple read pos=${this.pos} len=${e}`);return s}pushObj(e,r){return A.pushObj(this.stack,e,r)}readView(e,r){if(!Number.isFinite(e))throw this.err(`readView: wrong length=${e}`);if(this.pos+e>this.data.length)throw this.err("readView: Unexpected end of buffer");const s=r(this.view,this.pos);return this.markBytes(e),s}absBytes(e){if(e>this.data.length)throw new Error("Unexpected end of buffer");return this.data.subarray(e)}finish(){if(!this.opts.allowUnreadBytes){if(this.bitPos)throw this.err(`${this.bitPos} bits left after unpack: ${_.encode(this.data.slice(this.pos))}`);if(this.bs&&!this.parent){const e=b.indices(this.bs,this.data.length,!0);if(e.length){const r=b.range(e).map(({pos:s,length:i})=>`(${s}/${i})[${_.encode(this.data.subarray(s,s+i))}]`).join(", ");throw this.err(`unread byte ranges: ${r} (total=${this.data.length})`)}else return}if(!this.isEnd())throw this.err(`${this.leftBytes} bytes ${this.bitPos} bits left after unpack: ${_.encode(this.data.slice(this.pos))}`)}}err(e){return A.err("Reader",this.stack,e)}offsetReader(e){if(e>this.data.length)throw this.err("offsetReader: Unexpected end of buffer");return new ee(this.absBytes(e),this.opts,this.stack,this,e)}bytes(e,r=!1){if(this.bitPos)throw this.err("readBytes: bitPos not empty");if(!Number.isFinite(e))throw this.err(`readBytes: wrong length=${e}`);if(this.pos+e>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const s=this.data.subarray(this.pos,this.pos+e);return r||this.markBytes(e),s}byte(e=!1){if(this.bitPos)throw this.err("readByte: bitPos not empty");if(this.pos+1>this.data.length)throw this.err("readBytes: Unexpected end of buffer");const r=this.data[this.pos];return e||this.markBytes(1),r}get leftBytes(){return this.data.length-this.pos}get totalBytes(){return this.data.length}isEnd(){return this.pos>=this.data.length&&!this.bitPos}bits(e){if(e>32)throw this.err("BitReader: cannot read more than 32 bits in single call");let r=0;for(;e;){this.bitPos||(this.bitBuf=this.byte(),this.bitPos=8);const s=Math.min(e,this.bitPos);this.bitPos-=s,r=r<<s|this.bitBuf>>this.bitPos&2**s-1,this.bitBuf&=2**this.bitPos-1,e-=s}return r>>>0}find(e,r=this.pos){if(!z(e))throw this.err(`find: needle is not bytes! ${e}`);if(this.bitPos)throw this.err("findByte: bitPos not empty");if(!e.length)throw this.err("find: needle is empty");for(let s=r;(s=this.data.indexOf(e[0],s))!==-1;s++){if(s===-1||this.data.length-s<e.length)return;if(rt(e,this.data.subarray(s,s+e.length)))return s}}}class nt{constructor(e=[]){w(this,"pos",0);w(this,"stack");w(this,"buffers",[]);w(this,"ptrs",[]);w(this,"bitBuf",0);w(this,"bitPos",0);w(this,"viewBuf",new Uint8Array(8));w(this,"view");w(this,"finished",!1);this.stack=e,this.view=we(this.viewBuf)}pushObj(e,r){return A.pushObj(this.stack,e,r)}writeView(e,r){if(this.finished)throw this.err("buffer: finished");if(!L(e)||e>8)throw new Error(`wrong writeView length=${e}`);r(this.view),this.bytes(this.viewBuf.slice(0,e)),this.viewBuf.fill(0)}err(e){if(this.finished)throw this.err("buffer: finished");return A.err("Reader",this.stack,e)}bytes(e){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeBytes: ends with non-empty bit buffer");this.buffers.push(e),this.pos+=e.length}byte(e){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("writeByte: ends with non-empty bit buffer");this.buffers.push(new Uint8Array([e])),this.pos++}finish(e=!0){if(this.finished)throw this.err("buffer: finished");if(this.bitPos)throw this.err("buffer: ends with non-empty bit buffer");const r=this.buffers.concat(this.ptrs.map(a=>a.buffer)),s=r.map(a=>a.length).reduce((a,o)=>a+o,0),i=new Uint8Array(s);for(let a=0,o=0;a<r.length;a++){const d=r[a];i.set(d,o),o+=d.length}for(let a=this.pos,o=0;o<this.ptrs.length;o++){const d=this.ptrs[o];i.set(d.ptr.encode(a),d.pos),a+=d.buffer.length}if(e){this.buffers=[];for(const a of this.ptrs)a.buffer.fill(0);this.ptrs=[],this.finished=!0,this.bitBuf=0}return i}bits(e,r){if(r>32)throw this.err("writeBits: cannot write more than 32 bits in single call");if(e>=2**r)throw this.err(`writeBits: value (${e}) >= 2**bits (${r})`);for(;r;){const s=Math.min(r,8-this.bitPos);this.bitBuf=this.bitBuf<<s|e>>r-s,this.bitPos+=s,r-=s,e&=2**r-1,this.bitPos===8&&(this.bitPos=0,this.buffers.push(new Uint8Array([this.bitBuf])),this.pos++)}}}const oe=t=>Uint8Array.from(t).reverse();function ge(t){return{encodeStream:t.encodeStream,decodeStream:t.decodeStream,size:t.size,encode:e=>{const r=new nt;return t.encodeStream(r,e),r.finish()},decode:(e,r={})=>{const s=new ee(e,r),i=t.decodeStream(s);return s.finish(),i}}}function it(t,e){if(!O(t))throw new Error(`validate: invalid inner value ${t}`);if(typeof e!="function")throw new Error("validate: fn should be function");return ge({size:t.size,encodeStream:(r,s)=>{let i;try{i=e(s)}catch(a){throw r.err(a)}t.encodeStream(r,i)},decodeStream:r=>{const s=t.decodeStream(r);try{return e(s)}catch(i){throw r.err(i)}}})}const te=t=>{const e=ge(t);return t.validate?it(e,t.validate):e},at=t=>xe(t)&&typeof t.decode=="function"&&typeof t.encode=="function";function O(t){return xe(t)&&at(t)&&typeof t.encodeStream=="function"&&typeof t.decodeStream=="function"&&(t.size===void 0||L(t.size))}const ot=(t,e)=>te({size:t,encodeStream:(r,s)=>r.writeView(t,i=>e.write(i,s)),decodeStream:r=>r.readView(t,e.read),validate:r=>{if(typeof r!="number")throw new Error(`viewCoder: expected number, got ${typeof r}`);return e.validate&&e.validate(r),r}}),ct=(t,e,r)=>{const s=t*8,i=2**(s-1),a=c=>{if(!L(c))throw new Error(`sintView: value is not safe integer: ${c}`);if(c<-i||c>=i)throw new Error(`sintView: value out of bounds. Expected ${-i} <= ${c} < ${i}`)},o=2**s,d=c=>{if(!L(c))throw new Error(`uintView: value is not safe integer: ${c}`);if(0>c||c>=o)throw new Error(`uintView: value out of bounds. Expected 0 <= ${c} < ${o}`)};return ot(t,{write:r.write,read:r.read,validate:e?a:d})},ce=ct(1,!1,{read:(t,e)=>t.getUint8(e),write:(t,e)=>t.setUint8(0,e)}),F=(t,e=!1)=>{if(typeof e!="boolean")throw new Error(`bytes/le: expected boolean, got ${typeof e}`);const r=st(t),s=z(t);return te({size:typeof t=="number"?t:void 0,encodeStream:(i,a)=>{s||r.encodeStream(i,a.length),i.bytes(e?oe(a):a),s&&i.bytes(t)},decodeStream:i=>{let a;if(s){const o=i.find(t);if(!o)throw i.err("bytes: cannot find terminator");a=i.bytes(o-i.pos),i.bytes(t.length)}else a=i.bytes(t===null?i.leftBytes:r.decodeStream(i));return e?oe(a):a},validate:i=>{if(!z(i))throw new Error(`bytes: invalid value ${i}`);return i}})},dt=te({encodeStream(t,e){const r=Pe(e);F(11).encodeStream(t,new Uint8Array(11).fill(0)),ce.encodeStream(t,r.version),F(20).encodeStream(t,_.decode(r.hash160))},decodeStream(t){F(11).decodeStream(t);const e=ce.decodeStream(t),r=F(20).decodeStream(t);return De({hash160:_.encode(r),version:e,type:Ie.Address})}});function lt(t){return Be(Ue(t,{size:32}))}function ht(t){return lt(dt.encode(t))}const de=11155111;function be(t="testnet"){const[e,r]=x.useState(null),[s,i]=x.useState(!0),[a,o]=x.useState(null),[d,c]=x.useState(null),[h,m]=x.useState(null),u=t==="testnet"?Ve:void 0,S=x.useCallback(async l=>{try{const f=await l.request({method:"eth_chainId"});return f?parseInt(f,16):null}catch(f){return console.error("Error getting chain ID:",f),null}},[]),j=x.useCallback(async()=>{const l=typeof window<"u"&&window.ethereum?window.ethereum:void 0;if(!l)throw new Error("MetaMask is not installed");try{await l.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${de.toString(16)}`}]}),p.success("Switched to Sepolia testnet")}catch(f){if(f.code===4902)try{await l.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${de.toString(16)}`,chainName:"Sepolia",nativeCurrency:{name:"ETH",symbol:"ETH",decimals:18},rpcUrls:["https://ethereum-sepolia.publicnode.com"],blockExplorerUrls:["https://sepolia.etherscan.io"]}]}),p.success("Sepolia testnet added and switched")}catch(v){throw p.error("Failed to add Sepolia network"),v}else throw p.error("Failed to switch network"),f}},[]);x.useEffect(()=>{const l=typeof window<"u"&&window.ethereum?window.ethereum:void 0;if(!l){i(!1);return}(async()=>{try{const g=await l.request({method:"eth_accounts"}),N=await S(l);if(m(N),g.length>0){const $=Y(g[0]);r({address:$});const y=K({account:$,chain:u,transport:D(l)}),k=X({chain:u,transport:D(l)});o(y),c(k)}}catch(g){console.error("Error checking Ethereum connection:",g)}finally{i(!1)}})();const v=g=>{if(g.length===0)r(null),o(null),c(null);else{const N=Y(g[0]);r({address:N});const $=K({account:N,chain:u,transport:D(l)}),y=X({chain:u,transport:D(l)});o($),c(y)}},C=async g=>{const N=parseInt(g,16);m(N),window.location.reload()};return l.on("accountsChanged",v),l.on("chainChanged",C),()=>{l.removeListener("accountsChanged",v),l.removeListener("chainChanged",C)}},[u,S]);const B=x.useCallback(async()=>{const l=typeof window<"u"&&window.ethereum?window.ethereum:void 0;if(!l)throw p.error("MetaMask is not installed. Please install MetaMask to continue."),new Error("MetaMask not installed");try{const f=await S(l);m(f);const v=await l.request({method:"eth_requestAccounts"});if(v.length===0)throw new Error("No accounts found");const C=Y(v[0]);r({address:C});const g=K({account:C,chain:u,transport:D(l)}),N=X({chain:u,transport:D(l)});o(g),c(N),p.success("MetaMask connected!")}catch(f){throw f.code===4001?p.error("Please connect to MetaMask"):p.error((f==null?void 0:f.message)||"Failed to connect MetaMask"),f}},[u,S]),E=x.useCallback(()=>{r(null),o(null),c(null)},[]);return{account:e,isConnected:!!e,isLoading:s,connect:B,disconnect:E,address:(e==null?void 0:e.address)||null,walletClient:a,publicClient:d,chainId:h,switchToSepolia:j}}const ut=[{name:"depositToRemote",type:"function",stateMutability:"nonpayable",inputs:[{name:"value",type:"uint256"},{name:"remoteDomain",type:"uint32"},{name:"remoteRecipient",type:"bytes32"},{name:"localToken",type:"address"},{name:"maxFee",type:"uint256"},{name:"hookData",type:"bytes"}],outputs:[]}],le=[{name:"approve",type:"function",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"success",type:"bool"}]},{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{name:"balance",type:"uint256"}]}];function ft(t={}){const{network:e="testnet"}=t,{walletClient:r,publicClient:s,address:i,isConnected:a,connect:o,chainId:d,switchToSepolia:c}=be(e),[h,m]=x.useState(!1),[u,S]=x.useState(!1),[j,B]=x.useState(!1),[E,l]=x.useState(null),f=11155111,v=async(C,g)=>{var N,$;if(!a||!r||!s||!i){const y=new Error("Please connect your MetaMask wallet");l(y),p.error(y.message);try{await o()}catch{}throw y}if(e==="testnet"&&d!==f){const y=new Error("Please switch to Sepolia testnet");l(y),p.error("You must be on Sepolia testnet. Switching now...",{duration:3e3});try{return await c(),await new Promise(k=>setTimeout(k,1e3)),v(C,g)}catch{throw p.error("Failed to switch network. Please switch to Sepolia manually in MetaMask."),y}}m(!0),l(null);try{if(await s.getBalance({address:i})===0n)throw new Error("Insufficient native ETH balance for gas fees");const k=se(C,6),ye=se("0",6),Se=ht(g),Ce="0x";let q;try{q=await s.readContract({address:J[e],abi:le,functionName:"balanceOf",args:[i]})}catch(W){throw(N=W.message)!=null&&N.includes("returned no data")||($=W.message)!=null&&$.includes("0x")?new Error(`Failed to read USDC balance. Make sure you're on ${e==="testnet"?"Sepolia testnet":"Ethereum mainnet"} and the contract exists at this address.`):W}if(q<k)throw new Error(`Insufficient USDC balance. Required: ${C} USDC, Have: ${Number(q)/1e6} USDC`);S(!0),p.loading("Approving xReserve to spend USDC...",{id:"approve"});const je=await r.writeContract({address:J[e],abi:le,functionName:"approve",args:[ie[e],k],chain:r.chain||void 0});await s.waitForTransactionReceipt({hash:je}),p.success("Approval confirmed",{id:"approve"}),S(!1),B(!0),p.loading("Initiating bridge deposit to Stacks...",{id:"deposit"});const re=await r.writeContract({address:ie[e],abi:ut,functionName:"depositToRemote",args:[k,Le.STACKS,Se,J[e],ye,Ce],chain:r.chain||void 0});return await s.waitForTransactionReceipt({hash:re}),p.success("Bridge deposit initiated! USDCx will be minted on Stacks in ~15 minutes.",{id:"deposit"}),B(!1),m(!1),re}catch(y){const k=y instanceof Error?y:new Error((y==null?void 0:y.message)||"Bridge failed");throw l(k),p.error(k.message),m(!1),S(!1),B(!1),k}};return{bridgeUSDC:v,isPending:h,isApproving:u,isDepositing:j,error:E}}function pt({onBridged:t}){const{address:e}=Z(),{address:r,isConnected:s,connect:i,isLoading:a,chainId:o,switchToSepolia:d}=be("testnet"),[c,h]=x.useState(""),[m,u]=x.useState(!1),j=o===11155111,{bridgeUSDC:B,isPending:E,isApproving:l,isDepositing:f}=ft({network:"testnet"}),v=async()=>{if(!e){p.error("Please connect your Stacks wallet first");return}if(!s||!r){p.error("Please connect your MetaMask wallet");try{await i()}catch{}return}if(!c||parseFloat(c)<=0){p.error("Please enter a valid amount");return}if(parseFloat(c)<1){p.error("Minimum amount is 1 USDC on testnet");return}try{await B(c,e),h(""),t==null||t()}catch(g){console.error("Bridge error:",g)}};if(!m)return n.jsx(I,{className:"border-2 border-dashed border-primary/30",children:n.jsx(P,{className:"pt-6",children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You need USDCx on Stacks to deposit rent. Bridge USDC from Ethereum to get started."}),n.jsx(U,{variant:"outline",onClick:()=>u(!0),children:"Bridge USDC â†’ USDCx"})]})})});const C=typeof window<"u"&&window.ethereum&&window.ethereum.isMetaMask;return n.jsxs(I,{children:[n.jsxs(M,{children:[n.jsx(R,{children:"Bridge USDC to USDCx"}),n.jsx(T,{children:"Bridge USDC from Ethereum Sepolia to USDCx on Stacks testnet"})]}),n.jsxs(P,{className:"space-y-4",children:[!C&&n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-yellow-800",children:[n.jsx("strong",{children:"MetaMask Required:"})," Please install MetaMask browser extension to bridge USDC.",n.jsx("a",{href:"https://metamask.io/download/",target:"_blank",rel:"noopener noreferrer",className:"ml-1 text-yellow-900 underline",children:"Download MetaMask"})]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ethereum Wallet (MetaMask)"}),s&&r?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-800",children:"Connected"}),n.jsx("p",{className:"text-xs text-green-600",children:ne(r)})]}),n.jsx(U,{variant:"outline",size:"sm",onClick:()=>{window.location.reload()},children:"Disconnect"})]}),o&&n.jsx("div",{className:`p-3 rounded-lg border ${j?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("p",{className:`text-sm font-medium ${j?"text-green-800":"text-yellow-800"}`,children:["Network: ",j?"Sepolia Testnet":`Chain ID ${o}`]}),!j&&n.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"You must be on Sepolia testnet to bridge"})]}),!j&&n.jsx(U,{variant:"outline",size:"sm",onClick:d,className:"ml-2",children:"Switch to Sepolia"})]})})]}):n.jsx(U,{variant:"outline",onClick:i,disabled:a||!C,className:"w-full",isLoading:a,children:a?"Connecting...":"Connect MetaMask"})]}),e&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stacks Recipient Address"}),n.jsx("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:n.jsx("p",{className:"text-xs text-gray-600",children:ne(e)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (USDC)"}),n.jsx("input",{type:"number",step:"0.01",min:"1",value:c,onChange:g=>h(g.target.value),placeholder:"1.00",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none"}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Minimum: 1 USDC (testnet)"})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-blue-800",children:[n.jsx("strong",{children:"Process:"})," This will approve xReserve to spend your USDC, then initiate the bridge. USDCx will be minted on Stacks in ~15 minutes."]})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(U,{variant:"primary",onClick:v,disabled:E||!c||!s||!e||!C||!j,isLoading:E,className:"flex-1",children:l?"Approving...":f?"Bridging...":"Bridge USDC"}),n.jsx(U,{variant:"outline",onClick:()=>{u(!1),h("")},disabled:E,children:"Cancel"})]}),!j&&s&&n.jsx("p",{className:"text-xs text-yellow-600 text-center",children:"Please switch to Sepolia testnet to continue"})]})]})}function vt(){const{isConnected:t,connect:e}=Z(),[r,s]=x.useState(""),[i]=x.useState(BigInt(1)),{depositRent:a,isPending:o}=He(),{balance:d,formatted:c,isLoading:h}=qe(),{rentCollected:m}=Fe(i),{currentPeriod:u}=Oe(i);x.useEffect(()=>{},[]);const S=async()=>{if(!r||parseFloat(r)<=0){p.error("Please enter a valid amount");return}if(!t){p.error("Please connect your wallet");return}const f=BigInt(Math.floor(parseFloat(r)*1e6));if((d||BigInt(0))<f){p.error(`Insufficient USDCx balance. You have ${c} USDCx but need ${r} USDCx`);return}try{await a(i,r),s("")}catch(C){console.error(C)}},j=r&&parseFloat(r)>0?BigInt(Math.floor(parseFloat(r)*1e6)):BigInt(0),B=d||BigInt(0),E=B<j,l=B===BigInt(0);return t?n.jsx("main",{className:"flex-1 bg-gray-50 relative pattern-dots",children:n.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 relative z-10",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-4xl font-light text-foreground mb-3 tracking-tight",children:"Deposit Rent"}),n.jsx("p",{className:"text-gray-600 font-light text-lg",children:"Record a new rent payment with USDCx"})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsxs(I,{children:[n.jsxs(M,{children:[n.jsx(R,{children:"Your USDCx Balance"}),n.jsx(T,{children:"USDCx on Stacks testnet"})]}),n.jsx(P,{children:n.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-[#06B6D4]/10 rounded-lg p-4 border border-primary/20",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Balance:"}),n.jsx("span",{className:"text-lg font-semibold text-primary",children:h?"Loading...":`${c} USDCx`})]}),l&&!h&&n.jsx("div",{className:"mt-3 pt-3 border-t border-primary/20",children:n.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[n.jsx("strong",{children:"No USDCx in wallet."})," You need USDCx tokens to deposit rent."]})})]})})]}),l&&!h&&n.jsx(pt,{}),n.jsxs(I,{children:[n.jsxs(M,{children:[n.jsx(R,{children:"New Rent Payment"}),n.jsx(T,{children:"Enter the rent amount in USDCx"})]}),n.jsxs(P,{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (USDCx)"}),n.jsx("input",{type:"number",step:"0.01",value:r,onChange:f=>s(f.target.value),placeholder:"0.00",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none ${E?"border-red-300 bg-red-50":"border-gray-300"}`}),E&&n.jsxs("p",{className:"mt-1 text-sm text-red-600",children:["Insufficient balance. You need ",r," USDCx but only have ",c," USDCx."]})]}),n.jsx("div",{className:"bg-primary-light rounded-lg p-4",children:n.jsxs("p",{className:"text-sm text-primary-dark",children:[n.jsx("strong",{children:"Note:"})," This will transfer USDCx to the rent vault and record the deposit. Make sure you have enough USDCx for the deposit."]})}),n.jsx("div",{className:"flex gap-4",children:n.jsx(U,{variant:"primary",className:"flex-1",onClick:S,isLoading:o,disabled:E||l||!r||parseFloat(r)<=0,children:"Deposit Rent"})})]})]})]}),n.jsx("div",{children:n.jsxs(I,{children:[n.jsxs(M,{children:[n.jsx(R,{children:"Payment History"}),n.jsx(T,{children:u!==void 0?`Current Period: ${(u==null?void 0:u.toString())||"0"}`:"Loading..."})]}),n.jsx(P,{children:n.jsxs("div",{className:"space-y-4",children:[u!==void 0&&n.jsx("div",{className:"border-b border-gray-200 pb-4",children:n.jsxs("div",{className:"flex justify-between items-start mb-2",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-foreground",children:"Current Period"}),n.jsxs("p",{className:"text-sm text-gray-500",children:["Period ",(u==null?void 0:u.toString())||"0"]})]}),n.jsx("p",{className:"font-semibold text-primary",children:m?`${(Number(m)/1e6).toFixed(6)} USDCx`:"0 USDCx"})]})}),u===void 0&&n.jsx("p",{className:"text-gray-500 text-sm",children:"No rent history available"})]})})]})})]})]})}):n.jsx("main",{className:"flex-1 flex items-center justify-center",children:n.jsxs(I,{className:"max-w-md",children:[n.jsxs(M,{children:[n.jsx(R,{children:"Connect Your Wallet"}),n.jsx(T,{children:"Please connect your Stacks wallet to deposit rent"})]}),n.jsx(P,{children:n.jsx(U,{onClick:e,variant:"primary",className:"w-full",children:"Connect Stacks Wallet"})})]})})}export{vt as default};
